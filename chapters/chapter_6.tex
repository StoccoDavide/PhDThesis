%!TEX root = ../main.tex

\chapter{Conclusions and Future Work}
\label{chap6:conclusions}

\section{Conclusions}

In this thesis, we presented a methodology for the automatic index reduction of \ac{DAE} systems. The index reduction algorithm is based on the separation of the system into differential and algebraic parts with the help of symbolic linear algebra, \ie{}, \ac{LU} or \ac{FFLU} matrix factorization. However, the current capabilities of \Maple{} kernel do not allow for an effective handling of large expressions. This brought us to exploit the latest state-of-the-art symbolic computation techniques to manage large expressions and to reduce the computational complexity of the equations generated during the index reduction procedure. Notably, the open-source \LEM{} and \LAST{} libraries implement matrix factorization with large expression management techniques and form the core of the symbolic index reduction. The index reduction algorithm is implemented in the \Indigo{} software package, which is composed of a \Maple{} library for the symbolic analysis of \ac{DAE} systems, as well as a \Matlab{} library for the numerical integration of the reduced-index \ac{DAE} systems. Hence, the \Indigo{} software package is capable of automatically reducing the index of generic \ac{DAE} systems and provides a comprehensive set of tools for their solution, ranging from the involved symbolic manipulation to the \Matlab{} code generation for the numerical integration of the reduced-index \ac{DAE} systems.

Symbolic-numerical examples are presented to detail the capabilities of the proposed index reduction algorithm. The results show that the presented methodology is capable of consistently reducing high-index \ac{DAE} systems to index-0 \acp{DAE}. The computational cost of the expressions generated during the index reduction procedure is comparable to the original \ac{DAE} system in most of the examples. However, the \Maple{} symbolic computation kernel is not always able to perform the simplification due to either the size of the expressions or the complexity of the operations involved. As a consequence, the expression size increases significantly throughout the left reduction steps. Still, the presented algorithm can successfully reduce the index of the \ac{DAE} system. Yet, the numerical efficiency of the final \ac{DAE} system is degraded by the increased number of computations needed for the evaluation of the swollen expressions. The inclusion of large expression management techniques in the symbolic index reduction algorithm to limit expression swell, as well as to augment the \ac{DAE} system and obtain a more compact representation of the expressions generated during the index reduction procedure, proves to be a successful strategy. Indeed, tests show that the \ac{DAE} systems, which present intermediate expression swell during factorization, are successfully reduced to index-0 \acp{DAE} with the aid of the large expression management techniques, while also retaining a slightly more compact representation of the generated expressions compared to the reduced \ac{DAE} systems without augmentation. A comparison between the joint index reduction algorithm and numerical integration schemes offered by \Maple{} with those of \Indigo{} demonstrates the effectiveness of the proposed methodology and software implementation.

As a concluding remark, the symbolic index reduction algorithm that we presented in this thesis is capable of reducing the high-index \ac{DAE} systems. This provides a solid foundation for practical applications in various fields of engineering, as well as in the field of scientific computing. To this end, the \Indigo{} software package together with its supporting libraries, \LEM{} and \LAST{}, are made available to the public as open-source software (distributed under the BSD 3-Clause License). Future publications, such as~\cite{stocco2024imece_solution}, will aim at promoting the use of the proposed methodology and software package in the scientific community.

\section{Future Work}
\label{chap6:sec:future_work}

The symbolic index reduction algorithm presented in this thesis is a solid foundation for future research in the field of symbolic computation. Nonetheless, future efforts will focus on enhancing the algorithm to handle more complicated \ac{DAE} systems. Specifically, addressing expression swell mitigation techniques while guaranteeing the numerical stability of the reduced-index \ac{DAE} systems is crucial for optimizing the algorithm's performance. Thereby, there are several directions for future work that could be pursued. Some of the most promising are outlined here below.

\paragraph{Detection of Linear Index-1 Variables}

During the index reduction procedure of \ac{MB}-type \ac{DAE} systems, we noticed that the expressions swell occurs in the last factorization step. This is due to the presence of index-1 variables that are linearly present in the system's equations, which are substituted in the \ac{DAE} system by factorization. Notably, such variables correspond to the Lagrange multipliers. The detection of this type of linear index-1 variables would have a relevant impact on the optimization of the algorithm, as it would enable us to avoid the last factorization step, which is typically the most computationally expensive step in the algorithm.

\paragraph{System Augmentation}

One may also argue that veiling variables are linear index-1 variables. However, until this moment, we have only considered them as an auxiliary evaluation layer for the expressions generated during the index reduction procedure, and have not exploited their presence in the \ac{DAE} system as state variables. This system augmentation technique can be exploited whenever a ``complicated'' pivot is detected in the factorization process. Specifically, if a complicated expression is detected in the pivot position, we could substitute it with a veiling variable that will be also considered as a state variable. This would have the following benefits.
%
\begin{itemize}
  \setlength{\itemsep}{0pt}
  \item The augmentation introduces a new equation that grants us a 1 in the pivot position, which allows us to continue with the factorization process by keeping the complexity of the expressions under control.
  \item The numerical stability of the reduced-index \ac{DAE} system is better guaranteed, as the pivot is not a complicated expression, but instead a 1 in the diagonal of the matrix being factorized. Nonetheless, the overhead is relegated to the right-hand side of the system, which does not affect the numerical stability of the system.
\end{itemize}

Notably, the problem of finding consistent \acp{IC} for the augmented system would not get more complicated, as the newly introduced state variables would also be stored in the veiling variable vector. This allows us to find consistent \acp{IC} for the augmented system in almost the same straightforward manner as we did previously, \ie{}, the veils add an evaluation layer to the system and, once the \acp{IC} for the original state variables are found, the veiling variables' \acp{IC} can be computed by just evaluating their expressions at the initial time.

\paragraph{Computer Algebra System}

The \Maple{} \ac{CAS} is a powerful tool for symbolic computation. The current capabilities of the \Maple{} kernel do not allow for an effective handling of large expressions. This is why we resorted to the latest state-of-the-art symbolic computation techniques to handle large expressions and to mitigate the computational complexity of the expressions generated during the index reduction procedure. However, in some cases, the \Maple{} symbolic computation kernel struggles to perform the index reduction procedure. This is due to \ac{CAS}'s sensitivity to the size of the generated expressions. Despite this being a normal behavior for \acp{CAS}, it would be beneficial and interesting to explore the possibility of implementing the symbolic index reduction algorithm in a modern open-source \ac{CAS}. This would allow us to have more control over the symbolic computation kernel and to have an in-depth understanding of the \ac{CAS}. As a consequence, we would be able to exploit the full potential of the symbolic index reduction algorithm and optimize the algorithm's performance.

\section{Forthcoming Uses of the Proposed Technique}

In this thesis, we have only explored the capabilities of the proposed methodology in some application examples, which are mainly focused on the validation of the symbolic index reduction algorithm and the \Indigo{} software package. However, the proposed methodology has a wide range of applications in real-world problems. Some of the most promising applications are outlined here below.

\paragraph{Optimal Control}

\acp{DAE} found extensive application also in \ac{OCP}~\cite{gerdts2012optimal, gerdts2003optimal, gerdts2005gradient}. The proposed methodology can be used in \acp{OCP} to reduce the index of the \ac{DAE} system and to obtain an index-reduced formulation of the \ac{DAE} system. This would allow us to apply standard numerical integration schemes to solve the \ac{OCP}. Specifically, the index-0 \ac{DAE} system can be integrated as a standard \ac{ODE}, while the hidden constraints can be enforced by introducing a quadratic penalty term in the cost function. Without a doubt, \emph{ad hoc} solution schemes can be developed to handle the hidden constraints more efficiently, but this discussion is beyond the scope of this thesis.

Another approach would be to exploit a common interface between \ac{ODE} and \ac{DAE} systems. In particular, we can provide the \ac{OCP} solver with the values of the state variables derivatives, as well as the appropriate Jacobian matrices at any given time. How the Jacobian matrices are computed will be thereby hidden from the solver, which uses them to compute the \ac{OC} input. This would allow us to solve the \ac{OCP} by integrating \ac{DAE} systems likewise \acp{ODE}, while also enforcing invariants or hidden constraints and providing the Jacobian matrices at each time step.

\paragraph{Nonlinear Optimization}

Likewise \citet{shmoylova2013simplification}, \ac{NLP} problems can also be tackled using \ac{DAE} systems. Specifically, if one formulate the \ac{NLP} problem through a Lagrangian function, the \ac{KKT} conditions would yield a \ac{DAE} system of index-2. The proposed methodology can be used to reduce the index of the \ac{DAE} system and to obtain an index-0 \ac{DAE} system. This would allow us to apply numerical integration schemes to solve the \ac{NLP} problem.
