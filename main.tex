\documentclass[a5paper, 8pt, openright]{extbook} % book template, paper size is b5

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PACKAGES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Suppress some warnings -------------------------------------------------------
\usepackage{silence}
\WarningsOff[everypage] % Suppress warnings related to package everypage
%\pdfsuppresswarningpagegroup=1

\setlength{\parskip}{0pt}        % no space between paragraphs

% Maths ------------------------------------------------------------------------
\usepackage{amsmath}             % principal package for serious mathematical typesetting
\usepackage{empheq}              % emphasize equations
\usepackage{mathtools}           % improved version of amsmath
\usepackage{amssymb}             % particular mathematical symbols
\usepackage{bm}                  % bold math formula, similar to '\mathbf'
\usepackage{mathrsfs}            % math upper case letter fonts
\usepackage{amsthm}              % to define theorems, lemmas, etc
\usepackage{thmtools}            % to define theorems, lemmas, etc

\declaretheoremstyle[
  headfont=\normalfont\bfseries,
  notefont=\normalfont\bfseries\itshape,
  bodyfont=\itshape,
  numbered=unless unique,
  spaceabove=1.0em plus 0.25em minus 0.25em,
  qed={$\blacksquare$}, %\qedsymbol
  spacebelow=1.0em plus 0.25em minus 0.25em,
]{defstyle}

\declaretheorem[
  style=defstyle,
  title=Definition,
  refname={definition},
  Refname={Definition}
]{definition}

\declaretheoremstyle[
  headfont=\normalfont\bfseries,
  notefont=\normalfont\bfseries\itshape,
  bodyfont=\normalfont,
  numbered=unless unique,
  spaceabove=1.0em plus 0.25em minus 0.25em,
  qed={$\blacksquare$}, %\qedsymbol
  spacebelow=1.0em plus 0.25em minus 0.25em,
]{exstyle}

\declaretheorem[
  style=exstyle,
  title=Example,
  refname={example},
  Refname={Example}
]{example}

\renewenvironment{bmatrix}%
  {\left[\hspace{-.75\arraycolsep}\array{*{\value{MaxMatrixCols}}{c}}}%
  {\endarray\hspace{-.75\arraycolsep}\right]}

\newenvironment{system}%
  {\left\{\begin{array}{@{}r@{~}c@{~}l}}%
    {\end{array}\hspace{-.75\arraycolsep}\right.}

\renewenvironment{cases}%
  {\left\{\begin{array}{@{}l@{\;}lr@{}}}%
  {\end{array}\hspace{-.75\arraycolsep}\right.}

% Document settings ------------------------------------------------------------
\usepackage{geometry}            % change margins of the document
\usepackage{acronym}             % to define abbreviations
\usepackage{rotating}            % rotate objects
\usepackage{lscape}              % to write in landscape mode

% Text settings ----------------------------------------------------------------
\usepackage[dvipsnames]{xcolor}  % color the text
\usepackage{soul}                % to strike-through text
\usepackage{tcolorbox}           % create a colored box wrapping the text
\usepackage[final]{microtype}    % improves the spacing between words and letters
\usepackage{appendix}       % to create appendices
\usepackage[english]{babel}      % useful to interpret the language of the document
\usepackage[T1]{fontenc}         % to write correctly in Italian
\usepackage[utf8]{inputenc}      % to correctly write accented letter and other symbols
%\usepackage[latin1]{inputenc}    % codec input useful to write docs in Italian
%\usepackage[normalem]{ulem}      % underline command which will break over line ends
\usepackage{listings}            % to include code in the document
\usepackage{realboxes}           % to create boxes around text
\usepackage[spaces, hyphens]{url}                 % to write url in the document

\urlstyle{tt}                    % teletype font of the document (forced in the bibliography)
\lstset{                         % settings for the listings package
  basicstyle=\ttfamily,
  columns=fullflexible,
  keepspaces=false
}

\lstnewenvironment{mapleinline}[1][]
  {\lstset{
    frame=none,
    linewidth=1.0\textwidth,
    aboveskip=0.25em,
    belowskip=0.25em,
    #1
  }}{}

\lstnewenvironment{mapleboxed}[1][]
  {\lstset{
    frame=tbrl,
    linewidth=1.0\textwidth,
    belowskip=-0.5em,
    #1
  }}{}

% Fonts ------------------------------------------------------------------------
%\usepackage{lmodern}             % text font
\usepackage{mathspec}            % font selection for XeLaTeX
\defaultfontfeatures{Mapping=tex-text} % to support TeX conventions
\setallmainfonts[Numbers={Lining,Proportional}]{Adobe Caslon Pro} % normal document font
\setallsansfonts[Scale=1.0]{HvDTrial Brandon Grotesque} % sans-serif font (\textsf{})
\setallmonofonts[Scale=0.75]{JetBrains Mono} % mono spaced font (\texttt{})

\usepackage[sf,bf]{titlesec}     % to customize the titles of the document
\titleformat
{\chapter}                       % command
[display]                        % shape
{\sffamily\center\LARGE\bfseries} % format
{\underline{\MakeUppercase{\chaptertitlename}\quad\MakeUppercase{\thechapter}}}
{1.0em}                          % sep
{\huge\MakeUppercase}[\vspace{2.5em}] % before-code
\titleformat*{\section}{\sffamily\Large\bfseries\MakeUppercase}
\titleformat*{\subsection}{\sffamily\large\bfseries\MakeUppercase}
\titleformat*{\subsubsection}{\sffamily\bfseries\MakeUppercase}
\titleformat*{\paragraph}{\sffamily\bfseries\MakeUppercase}
\titleformat*{\subparagraph}{\sffamily\bfseries\MakeUppercase}
\usepackage{textgreek}           % to write greek letters in text mode
\usepackage{fontawesome5}        % to use icons in the document

% Units ------------------------------------------------------------------------
\usepackage{siunitx}             % write unit of measurements

% Citations --------------------------------------------------------------------

\definecolor{blue_ncs}{rgb}{0.0, 0.53, 0.74}
\usepackage[
  colorlinks  = true,
  linkcolor   = black,
  urlcolor    = blue_ncs,
  citecolor   = blue_ncs,
  anchorcolor = black
]{hyperref}                      % generate hyper-reference links in the pdf document
\usepackage{cleveref}            % to reference equations, figures, tables, etc

% Figures and tables -----------------------------------------------------------
\usepackage{graphicx}            % advanced package to load figures
\usepackage{booktabs}            % enhance table quality: midrule, toprule, etc
\usepackage{tabularx}            % to create tables with a fixed width
\usepackage{float}               % improve the interface to define figs and tables
\usepackage{multirow}            % multi rows cells in a table
\usepackage{longtable}           % long tables
\usepackage{makecell}            % to make cells in a table
\usepackage{multicol}            % multi columns cells in a table
\usepackage{caption}             % to customize the captions in floating environments
\usepackage{subcaption}          % again used to customize the captions
\usepackage{overpic}             % to put text over a figure
\newcolumntype{Y}{>{\centering\arraybackslash}X}
\renewcommand{\theadalign}{cl}
\renewcommand{\cellalign}{cl}

% Algorithms and code ----------------------------------------------------------
\usepackage{algpseudocode}       % to write algorithms
\usepackage{algorithm}           % to write algorithms
\usepackage{algorithmicx}        % to write algorithms

\algnewcommand{\IfThen}[2]{% \IfThenElse{<if>}{<then>}
  \State \algorithmicif\ #1\ \algorithmicthen\ #2}
\algnewcommand{\IfThenElse}[3]{% \IfThenElse{<if>}{<then>}{<else>}
  \State \algorithmicif\ #1\ \algorithmicthen\ #2\ \algorithmicelse\ #3}

\makeatletter
\newenvironment{breakablealgorithm}
  {% \begin{breakablealgorithm}
    \begin{center}
      \small
      \refstepcounter{algorithm}% New algorithm
      \hrule height.8pt depth0pt \kern2pt% \@fs@pre for \@fs@ruled
      \renewcommand{\caption}[2][\relax]{% Make a new \caption
        {\raggedright\textbf{\ALG@name~\thealgorithm} ##2\par}%
        \ifx\relax##1\relax % #1 is \relax
          \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##2}%
        \else % #1 is not \relax
          \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##1}%
        \fi
        \kern2pt\hrule\kern2pt
      }
  }{% \end{breakablealgorithm}
      \kern2pt\hrule\relax% \@fs@post for \@fs@ruled
    \end{center}
  }
\makeatother

% TikZ and PGFPlots ------------------------------------------------------------
\usepackage{tikz}                % to draw figures
\usepackage{pgfplots}            % external TikZ/PGF plots support
\pgfplotsset{compat=1.18}        % compatibility mode
%\pgfplotsset{plot coordinates/math parser=false} % to avoid math parser
%\pgfplotsset{/pgf/number format/assume math mode=true}
\usepgfplotslibrary{external}    % load the externalization library
\usetikzlibrary{external}        % use the externalization library
\tikzexternalize[mode=convert with system call, prefix=figures/externalized/]
\usepgfplotslibrary{fillbetween} % fill the area between two curves
\usepgfplotslibrary{colorbrewer} % colorbrewer library
\pgfplotsset{colormap/PuOr-4}    % colormap for the plots
\pgfkeys{/pgf/number format/.cd, 1000 sep={}} % no thousand separator in the plots

\makeatletter
  \tikzset{%
    external/system call={%
        xelatex %
        \tikzexternalcheckshellescape %
        -halt-on-error %
        -interaction=batchmode %
        -output-directory="out" %
        -jobname "\image" %
        "\texsource"%
    },
    /pgf/images/include external/.code={%
        \includegraphics{out/#1}%
    },%
  }
\makeatother

% layers definition
\pgfplotsset{
  layers/my layer set/.define layer set={
    main,
    back,
    middle,
    front,
  }{}
}

% include tikz images and set externalization filename
\newcommand{\includetikz}[1]{%
  % substitute dots and slash in filename with underscores
  \StrSubstitute{#1}{./}{}[\temp]%
  \StrSubstitute{\temp}{.}{_}[\temp]%
  \StrSubstitute{\temp}{/}{_}[\temp]%
  \tikzsetnextfilename{\temp}%
  \input{#1}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DOCUMENT SETUP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Set custom margins for the document ------------------------------------------
\newgeometry{top=2.5cm, bottom=2.0cm, left=2.0cm, right=2.0cm} % digital version
%\newgeometry{top=2.0cm, bottom=2.0cm, width=11.0cm, bindingoffset=1.2cm} % print version
%headsep=0.25in, headheight=20pt, heightrounded

% Write 10^0 instead of 1 (requires 'siunitx') ---------------------------------
\sisetup{retain-zero-exponent=false, parse-numbers=false, per-mode=symbol}

% Modify layout of command SIrange (requires 'siunitx') ------------------------
\sisetup{range-phrase = \text{ -- }}

% Set the indent length to zero ------------------------------------------------
\setlength\parindent{0pt}
\setlength\itemsep{0pt}

% Set new units (not present in the 'siunitx' package) -------------------------
\DeclareSIUnit\feet{ft}
\DeclareSIUnit\foot{ft}
\DeclareSIUnit\slugs{slugs}

% Set the path of the figure files ---------------------------------------------
\graphicspath{
  {figures/frontmatter/}
  {figures/chapter_1/}
  {figures/chapter_2/}
  {figures/chapter_3/}
  {figures/chapter_4/}
  {figures/appendix_1/}
  {figures/appendix_2/}
  {figures/appendix_3/}
  {figures/appendix_4/}
}

% Insert a date ----------------------------------------------------------------
\date{January 2024}

% Bibliography -----------------------------------------------------------------
\PassOptionsToPackage{%
  backend=biber, bibencoding=utf8, % instead of bibtex
  language=auto,                   % get the language of the main document
  style=numeric-comp,              % numeric citation style
  sorting=none,                    % sorted by appearance
  maxbibnames=10,                  % default: 3, et al.
  maxcitenames=10,                 % default: 1, et al.
  natbib=true,                     % natbib compatibility mode (\citep and \citet still work)
}{biblatex}
\usepackage{biblatex} % to display bibliography
\usepackage{bibentry} % to insert bibliography entries inline
\emergencystretch=1em

\renewcommand*{\mkbibnamefamily}[1]{% mkbibcompletename
  \ifitemannotation{jointfirst}
    {#1\textsuperscript{\dag}}
    {#1}}

\addbibresource{bibliography.bib}

% Reduce the margin of the summary/abstract ------------------------------------------
%\def\changemargin#1#2{
%  \list{}{\rightmargin#2\leftmargin#1}
%  \item[]}
%\let\endchangemargin=\endlist

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DEFINITIONS OF COMMANDS AND VARIABLES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Create the 'abstract' environment (not present by default in the 'book' class)
\newcommand{\summaryname}{Abstract}
\newenvironment{abstract}{
  \begin{center}
    {\sffamily\Large\bfseries\MakeUppercase\summaryname}
  \end{center}
}

% Definitions of new table columns commands (require package 'array') ----------
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}

% Definitions of mathematical commands to typeset many things ------------------

\newtheorem{observation}{Observation}
\newtheorem{remark}{Remark}

% General commands
\newcommand{\eg}{\emph{e.g.}}
\newcommand{\ie}{\emph{i.e.}}
\newcommand{\USI}[1]{\unit{#1}}
\newcommand{\SSI}[2]{\SI{#1}{#2}}
\newcommand{\RSI}[3]{\lbrack\num{#1}{,}\ \num{#2}\rbrack\,\USI{#3}}

% Software programs
\newcommand{\MacOS}{\textsc{MacOS}\textsuperscript{\textregistered}}
\newcommand{\Windows}{\textsc{Windows}\textsuperscript{\textregistered}}
\newcommand{\Linux}{\textsc{Linux}\textsuperscript{\textregistered}}
\newcommand{\MapleSoft}{\textsc{MapleSoft}\textsuperscript{\textregistered}}
\newcommand{\Maple}{\textsc{Maple}\textsuperscript{\textregistered}}
\newcommand{\Wolfram}{\textsc{Wolfram}}
\newcommand{\Mathematica}{\textsc{Mathematica}\textsuperscript{\textregistered}}
\newcommand{\Matlab}{\textsc{Matlab}\textsuperscript{\textregistered}}
\newcommand{\Modelica}{\textsc{Modelica}}
\newcommand{\OpenModelica}{\textsc{OpenModelica}}
\newcommand{\ModelingToolkit}{\textsc{ModelingToolkit}}
\newcommand{\Simulink}{\textsc{Simulink}\textsuperscript{\textregistered}}
\newcommand{\Mex}{\textsc{Mex}}
\newcommand{\SFunction}{\textsc{S-Function}}
\newcommand{\SymPy}{\textsc{SymPy}}
\newcommand{\Axiom}{\textsc{Axiom}}
\newcommand{\Derive}{\textsc{Derive}}
\newcommand{\Macsyma}{\textsc{Macsyma}}
\newcommand{\MuPAD}{\textsc{MuPAD}}
\newcommand{\Reduce}{\textsc{Reduce}}
\newcommand{\TrussMe}{\textsc{TrussMe-Fem}}
\newcommand{\Ansys}{\textsc{Ansys}\textsuperscript{\textregistered}}

% Miscellaneous libraries, languages and tools
\newcommand{\cc}{C}
\newcommand{\cpp}{\cc{}++}
\newcommand{\Fortran}{\textsc{Fortran}}
\newcommand{\Python}{\textsc{Python}}
\newcommand{\html}{HTML}
\newcommand{\CGAL}{CGAL}
\newcommand{\LEM}{LEM}
\newcommand{\SIG}{SIG}
\newcommand{\LAST}{LAST}
\newcommand{\LULEM}{\textsc{LULEM}}
\newcommand{\Indigo}{\textsc{Indigo}}
\newcommand{\Doxygen}{\textsc{Doxygen}}
\newcommand{\Sphinx}{\textsc{Sphinx}}
\newcommand{\CMake}{\textsc{CMake}}
\newcommand{\Const}{\textsc{Const}}
\newcommand{\SharedPointer}{\textsc{SharedPointer}}

% Eigen namespace and classes
\newcommand{\Eigen}{\textsc{Eigen}}
\newcommand{\MatrixBase}{\textsc{MatrixBase}}

% Acme namespace and classes
\newcommand{\Acme}{\textsc{Acme}}
\newcommand{\Entity}{\textsc{Entity}}
\newcommand{\Entities}{\textsc{Entities}}
\newcommand{\Point}{\textsc{Point}}
\newcommand{\Line}{\textsc{Line}}
\newcommand{\Ray}{\textsc{Ray}}
\newcommand{\Plane}{\textsc{Plane}}
\newcommand{\Segment}{\textsc{Segment}}
\newcommand{\Triangle}{\textsc{Triangle}}
\newcommand{\Disk}{\textsc{Disk}}
\newcommand{\Ball}{\textsc{Ball}}
\newcommand{\Collection}{\textsc{Collection}}
\newcommand{\Aabb}{\textsc{AABB}}
\newcommand{\AabbTree}{\textsc{AABBtree}}

% Enve namespace and classes
\newcommand{\Enve}{\textsc{Enve}}
\newcommand{\TriangleGround}{\textsc{TriangleGround}}
\newcommand{\Mesh}{\textsc{Mesh}}
\newcommand{\Flat}{\textsc{Flat}}
\newcommand{\Rib}{\textsc{Rib}}
\newcommand{\Shape}{\textsc{Shape}}
\newcommand{\Shell}{\textsc{Shell}}
\newcommand{\Tire}{\textsc{Tire}}
\newcommand{\Road}{\textsc{Road}}

% Tire models
\newcommand{\MagicFormulae}{\textsc{Magic Formula}}
\newcommand{\Swift}{\textsc{Swift}\textsuperscript{\textregistered}}
\newcommand{\TMEasy}{\textsc{TMEasy}}
\newcommand{\FTire}{\textsc{FTire}\textsuperscript{\textregistered}}
\newcommand{\CDTire}{\textsc{CDTire}\textsuperscript{\textregistered}}

% Goodlooking check, cross and warning marks
\newcommand{\mycheckmark}{\textcolor{mycolor5}{\faCheck}}
\newcommand{\mycrossmark}{\textcolor{mycolor2}{\faTimes}}
\newcommand{\mywarnmark}{\textcolor{mycolor3}{\faExclamationTriangle}}

% Mathematical symbols
\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\pt}[1]{\ensuremath{\mathbf{#1}}}
\newcommand{\vt}[1]{\ensuremath{\vec{\pt{#1}}}}
\newcommand{\et}[1]{\ensuremath{\hat{\pt{#1}}}}

\newcommand{\sett}[1]{\ensuremath{\mathcal{#1}}}
\newcommand{\boundary}[1]{\ensuremath{\partial{\sett{#1}}}}
\newcommand{\interior}[1]{\ensuremath{\mathring{\sett{#1}}}}

\newcommand{\de}{\mathrm{d}}

% Matrices and vectors
\newcommand{\dif}[2]{\ensuremath{{#1}_{#2}}}
\newcommand{\jac}[2]{\ensuremath{{#1}_{#2}}}
\newcommand{\hes}[2]{\ensuremath{{#1}_{#2}}}
\newcommand{\m}[1]{\ensuremath{\mathbf{#1}}}
\newcommand{\mx}{\ensuremath{\m{x}}}
\newcommand{\mxp}{\ensuremath{\mx^\prime}}
\newcommand{\mE}{\ensuremath{\m{E}(\mx, t)}}
\newcommand{\mg}{\ensuremath{\m{g}(\mx, t)}}
\newcommand{\ma}{\ensuremath{\m{a}(\mx, t)}}
\newcommand{\mA}{\ensuremath{\m{A}(\mx, t)}}
\newcommand{\mN}{\ensuremath{\m{N}(\mx, t)}}
\newcommand{\mK}{\ensuremath{\m{K}(\mx, t)}}
\newcommand{\mI}{\ensuremath{\m{I}}}
\newcommand{\mP}{\ensuremath{\m{P}}}
\newcommand{\mQ}{\ensuremath{\m{Q}}}
\newcommand{\mL}{\ensuremath{\m{L}(\mx, t)}}
\newcommand{\mU}{\ensuremath{\m{U}(\mx, t)}}
\newcommand{\mM}{\ensuremath{\m{M}(\mx, t)}}
\newcommand{\mb}{\ensuremath{\m{b}(\mx, t)}}
\newcommand{\mAd}{\ensuremath{\m{E}_{\m{a}}(\mx, t)}}
\newcommand{\mgd}{\ensuremath{\m{g}_{\m{a}}(\mx, t)}}
\newcommand{\mF}{\ensuremath{\m{F}(\mx, \mxp, t)}}
\newcommand{\mh}{\ensuremath{\m{h}(\mx, t)}}

\newcommand{\mv}{\ensuremath{\m{v}(\mx, t)}}
\newcommand{\mEv}{\ensuremath{\m{E}(\mx, \m{v}, t)}}
\newcommand{\mgv}{\ensuremath{\m{g}(\mx, \m{v}, t)}}
\newcommand{\mav}{\ensuremath{\m{a}(\mx, \m{v}, t)}}
\newcommand{\mvv}{\ensuremath{\m{v}(\mx, \m{v}, t)}}
\newcommand{\mAv}{\ensuremath{\m{A}(\mx, \m{v}, t)}}
\newcommand{\mNv}{\ensuremath{\m{N}(\mx, \m{v}, t)}}
\newcommand{\mKv}{\ensuremath{\m{K}(\mx, \m{v}, t)}}
\newcommand{\mLv}{\ensuremath{\m{L}(\mx, \m{v}, t)}}
\newcommand{\mUv}{\ensuremath{\m{U}(\mx, \m{v}, t)}}
\newcommand{\mMv}{\ensuremath{\m{M}(\mx, \m{v}, t)}}
\newcommand{\mbv}{\ensuremath{\m{b}(\mx, \m{v}, t)}}
\newcommand{\mAdv}{\ensuremath{\m{E}_{\m{a}}(\mx, \m{v}, t)}}
\newcommand{\mgdv}{\ensuremath{\m{g}_{\m{a}}(\mx, \m{v}, t)}}
\newcommand{\mFv}{\ensuremath{\m{F}(\mx, \mxp, \m{v}, t)}}
\newcommand{\mhv}{\ensuremath{\m{h}(\mx, \m{v}, t)}}
\newcommand{\mhiv}{\ensuremath{\m{h}_{i}(\mx, \m{v}, t)}}
\newcommand{\mhuv}{\ensuremath{\m{h}_{u}(\mx, \m{v}, t)}}

\newcommand{\cf}{\ensuremath{\,\mathrm{f}}}
\newcommand{\cm}{\ensuremath{\,\mathrm{m}}}
\newcommand{\cd}{\ensuremath{\,\mathrm{d}}}
\newcommand{\ca}{\ensuremath{\,\mathrm{a}}}
\newcommand{\cv}{\ensuremath{\,\mathrm{v}}}

\newcommand{\eqdef}{\mathrel{\overset{\mathrm{\tiny{def}}}{=}}}
\newcommand{\bfell}{\ensuremath{\mathcal{L}}}
\newcommand{\huvec}{\ensuremath{\hat{\mathbf{n}}}}
\newcommand{\euvec}{\ensuremath{\hat{\mathbf{e}}}}
\newcommand{\road}{\ensuremath{\mathcal{R}}}
\newcommand{\tire}{\ensuremath{\mathcal{T}}}
\newcommand{\cp}{\ensuremath{\mathcal{P}}}
\newcommand{\adh}{\ensuremath{\mathcal{A}}}
\newcommand{\sli}{\ensuremath{\mathcal{S}}}

\newcommand{\mini}{\ensuremath{\mathrm{\min}}}
\newcommand{\maxi}{\ensuremath{\mathrm{\max}}}
\newcommand{\meai}{\ensuremath{\mathrm{\mu}}}
\newcommand{\vari}{\ensuremath{\mathrm{\sigma^2}}}

\newcommand{\undx}{\ensuremath{\pt{x}}}
\newcommand{\undt}{\ensuremath{\pt{t}}}
\newcommand{\Fiala}{\textsc{Fiala}}
\newcommand{\NeoFiala}{\textsc{Neo-Fiala}}
\newcommand{\TreadSim}{\textsc{TreadSim}}
\newcommand{\TaMeTire}{\textsc{TaMeTire}\textsuperscript{\textregistered}}
\newcommand{\Hoosier}{\textsc{Hoosier}\textsuperscript{\textregistered}}

% Commands for the structural analysis
\newcommand{\Je}{\mathbf{J}_{e}}
\newcommand{\Ke}{\mathbf{K}_{e}}
\newcommand{\Kc}{\mathbf{K}_{c}}
\newcommand{\Ne}{N_{e}}
\newcommand{\Pe}{\mathbf{P}_{e}}
\renewcommand{\Re}{\mathbf{R}_{e}}
\newcommand{\Te}{\mathbf{T}_{e}}
%\newcommand*\circled[1]{\tikz[baseline=(char.base)]{\node[shape=circle,draw,inner sep=2pt] (char) {#1};}}
\newcommand*\circled[1]{{\large \textcircled{\small #1}}}

% Matlab colors
\definecolor{mycolor1}{rgb}{0.00000,0.44700,0.74100}
\definecolor{mycolor2}{rgb}{0.85000,0.32500,0.09800}
\definecolor{mycolor3}{rgb}{0.92900,0.69400,0.12500}
\definecolor{mycolor4}{rgb}{0.49400,0.18400,0.55600}
\definecolor{mycolor5}{rgb}{0.46600,0.67400,0.18800}
\definecolor{mycolor6}{rgb}{0.30100,0.74500,0.93300}
\definecolor{mycolor7}{rgb}{0.63500,0.07800,0.18400}

% Dynafit Low Tech colors
\definecolor{dlt_purple}{RGB}{71, 34, 121}
\definecolor{dlt_yellow}{RGB}{200, 209, 6}
\definecolor{dlt_pink}{RGB}{224, 36, 125}

% Tricks to fix the DOI link in the bibliography
\makeatletter
  \DeclareMathSymbol{0}{\mathalpha}{\eu@DigitsArabic@symfont}{`0}
  \DeclareMathSymbol{1}{\mathalpha}{\eu@DigitsArabic@symfont}{`1}
  \DeclareMathSymbol{2}{\mathalpha}{\eu@DigitsArabic@symfont}{`2}
  \DeclareMathSymbol{3}{\mathalpha}{\eu@DigitsArabic@symfont}{`3}
  \DeclareMathSymbol{4}{\mathalpha}{\eu@DigitsArabic@symfont}{`4}
  \DeclareMathSymbol{5}{\mathalpha}{\eu@DigitsArabic@symfont}{`5}
  \DeclareMathSymbol{6}{\mathalpha}{\eu@DigitsArabic@symfont}{`6}
  \DeclareMathSymbol{7}{\mathalpha}{\eu@DigitsArabic@symfont}{`7}
  \DeclareMathSymbol{8}{\mathalpha}{\eu@DigitsArabic@symfont}{`8}
  \DeclareMathSymbol{9}{\mathalpha}{\eu@DigitsArabic@symfont}{`9}
\makeatother

% Pages numbering --------------------------------------------------------------
\makeatletter
\newcommand*{\emptystyles}{% remove page style
\let\oldplain\ps@plain
\let\ps@plain\ps@empty
\pagestyle{empty}}

\newcommand*{\restorestyles}{% restore page style
\clearpage\thispagestyle{empty}
\let\ps@plain\oldplain
\pagestyle{headings}}

\let\ps@plain\ps@empty% remove page numbers from chapter pages

\newcommand*\std@chapter{} % use long titles in toc and short one in headers
\let\std@chapter=\@chapter
\renewcommand*\@chapter[2][]{\std@chapter[#2]{#2}\chaptermark{#1}}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BEGIN DOCUMENT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

% Frontmatter ------------------------------------------------------------------
\emptystyles
\include{frontmatter/frontmatter}
\hbox{}
\thispagestyle{empty}
\newpage

% Copyright --------------------------------------------------------------------
\subsection*{Copyright Notice}

The content of this thesis is the result of the author's original research work. Permission to include the following published material for non-commercial purposes is granted by the publishers' copyright policy. The published works are cited in the bibliography and are listed below.
%
\begin{itemize}
  \setlength{\itemsep}{0.0em}
  \item \fullcite{stocco2021acme}
  \item \fullcite{stocco2024symbolic}
  \item \fullcite{stocco2024matrix}
  \item \fullcite{stocco2024novel}
  \item \fullcite{stocco2024physical}
\end{itemize}

\subsection*{Material Submitted for Publication}

This thesis contains material that is currently submitted for publication. The material has not yet been published, and this thesis provides a short adapted version of its content. The submitted works are cited in the bibliography and are listed below.
%
\begin{itemize}
  \setlength{\itemsep}{0.0em}
  \item \fullcite{stocco2024trussme}
  \item \fullcite{stocco2024imece_solution}
  \item \fullcite{larcher2024imece_symbolic}
\end{itemize}
%
\dag{}: The authors contributed equally to the work.

\vspace*{\fill}

\begin{center}
  Copyright \textcopyright{} 2024 Davide Stocco \\
\end{center}
\thispagestyle{empty}
\cleardoublepage

% Abstract ---------------------------------------------------------------------
\include{abstract/abstract}
\vspace*{\fill}

% Table of contents ------------------------------------------------------------
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{2}
\tableofcontents
\restorestyles

% List of abbreviations --------------------------------------------------------
\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{List of Abbreviations}
\chapter*{List of Abbreviations}
\markboth{LIST OF ABBREVIATIONS}{}
\begin{multicols}{2}
  \begin{acronym}[XXXXXXXX]
    \setlength{\itemsep}{-0.5em}
    \acro{AABB}{Axis-Aligned Bounding Box}
    \acro{AD}{Automatic Differentiation}
    \acro{ADAS}{Advanced Driver-Assistance Systems}
    \acro{AI}{Artificial Intelligence}
    \acro{API}{Application Programming Interface}
    \acro{BC}{Boundary Condition}
    \acro{BDF}{Backward Differentiation Formula}
    \acro{BLAS}{Basic Linear Algebra Subprograms}
    \acro{BSD}{Berkeley Software Distribution}
    \acro{BVH}{Bounding Volume Hierarchy}
    \acro{BVM}{Bounding Value Method}
    \acro{BVP}{Bounding Volume Primitive}
    \acro{CAS}{Computer Algebra System}
    \acro{CERN}{Conseil Europ{\'e}en pour la Recherche Nucl{\'e}aire}
    \acro{CPU}{Central Processing Unit}
    \acro{DAE}{Differential-Algebraic Equation}
    \acro{DE}{Discrete Element}
    \acro{DOF}{Degree of Freedom}
    \acro{DIL}{Driver In the Loop}
    \acro{DSM}{Direct Stiffness Method}
    \acro{FE}{Finite Element}
    \acro{FEA}{Finite Element Analysis}
    \acro{FEM}{Finite Element Method}
    \acro{FFLU}{Fraction-Free Lower-Upper}
    \acro{FSAE}{Formula SAE}
    \acro{GPU}{Graphics Processing Unit}
    \acro{GJ}{Gauss-Jordan}
    \acro{GUI}{Graphical User Interface}
    \acro{HIL}{Hardware In the Loop}
    \acro{HRT}{Hard Real-Time}
    \acro{IC}{Initial Condition}
    \acro{IVP}{Initial Value Problem}
    \acro{KKT}{Karush-Kuhn-Tucker}
    \acro{LLNL}{Lawrence Livermore National Laboratory}
    \acro{LAPACK}{Linear Algebra PACKage}
    \acro{LU}{Lower-Upper}
    \acro{MB}{Multi-Body}
    \acro{MBD}{Multi-Body Dynamics}
    \acro{MIT}{Massachusetts Institute of Technology}
    \acro{MBS}{Multi-Body System}
    \acro{MPL}{Mathematical Pseudo-Language}
    \acro{NASA}{National Aeronautics and Space Administration}
    \acro{NLP}{nonlinear Programming}
    \acro{OC}{Optimal Control}
    \acro{OCP}{Optimal Control Problem}
    \acro{ODE}{Ordinary Differential Equation}
    \acro{OS}{Operative System}
    \acro{PDAE}{Partial Differential-Algebraic Equation}
    \acro{PDE}{Partial Differential Equation}
    \acro{RAM}{Random Access Memory}
    \acro{RDF}{Road Data Format}
    \acro{RK}{Runge-Kutta}
    \acro{RKF}{Runge-Kutta-Fehlberg}
    \acro{RT}{Real-Time}
    \acro{RTF}{Real-Time Factor}
    \acro{RMS}{Root Mean Square}
    \acro{SA}{Structural Analysis}
    \acro{SAE}{Society of Automotive Engineers}
    \acro{SIL}{Software In the Loop}
    \acro{SRT}{Soft Real-Time}
    \acro{SUNDIALS}{SUite of Nonlinear and DIfferential-ALgebraic equation Solvers}
    \acro{SVD}{Singular Value Decomposition}
    \acro{TIRF}{Tire Research Facility}
    \acro{TTC}{Tire Test Consortium}
    \acro{TPPC}{Trajectory Prescribed Path Control}
    \acro{UHD}{Ultra High Definition}
  \end{acronym}
\end{multicols}

% Mainmatter -------------------------------------------------------------------
\include{chapters/chapter_1}
\include{chapters/chapter_2}
\include{chapters/chapter_3}
\include{chapters/chapter_4}
\include{chapters/chapter_5}
\include{chapters/chapter_6}
\begin{appendices}
\include{appendices/appendix_1}
\include{appendices/appendix_2}
\include{appendices/appendix_3}
\include{appendices/appendix_4}
\end{appendices}

% Bibliography -----------------------------------------------------------------
\addcontentsline{toc}{chapter}{Bibliography}
\DeclareFieldFormat{doi}{%
  \textsc{Doi}\addcolon\space%
  \ifhyperref{%
  \href{https://doi.org/#1}{%
    \nolinkurl{#1}%
  }
  }{%
    \nolinkurl{#1}%
  }
}
\printbibliography

% Acknowledgments --------------------------------------------------------------
%\addcontentsline{toc}{chapter}{Acknowledgments (Ringraziamenti)}
%\include{acknowledgments/acknowledgments}

\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% END DOCUMENT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
